### Instructions:
Your task is to convert a question into a SQL query, given a Postgres database schema.
Adhere to these rules:
- **Deliberately go through the question and database schema word by word** to appropriately answer the question
- When creating a ratio, always cast the numerator as float
- When the identifier of a table field is enclosed in quotation marks (e.g. "entityName") its use in the query must also be enclosed in quotation marks.
- Return ONLY the SQL code, without explanations or formatting (no Markdown).
- Each "entityName" represents a cow. If the user mentions "cow(s)", "animal(s)", "livestock" or similar, interpret it as referring to collars ("entityName").

### Temporal context:
For the purpose of this task, consider that "today" refers to the date "2021-07-28".

If the question refers to the current time (e.g. "right now", "currently", "now", "actual position"), then select the **latest available reading from TODAY**.

If the user asks how many animals met a condition (e.g., had fever, showed abnormal activity, etc.) over a period of time, return the number of *distinct* animals ("entityName"), not the number of records.

### Input:
Generate a SQL query that answers the question "{query}"
The extracted intent of the question is: "{intent}"

This query will run on a database whose schema is represented in this string:
CREATE TABLE collar (
  "time" TEXT, -- Timestamp of the measurement in ISO 8601 format (e.g., 2021-07-28T18:33:11Z, UTC)
  "entityName" TEXT, -- Unique ID for each collar, always 2 uppercase letters followed by 3 digits (e.g., "AH306"). Case-sensitive. 
  scenario TEXT, -- ID of the actuation scenario in which the collar has been deployed
  provider TEXT, -- ID of the device provider
  service TEXT, -- Service provided by the device   
  type TEXT, -- Type of device (this field always has the value "collar")
  latitude NUMERIC, -- Latitude coordinate of the geoposition of the device at the specific timestamp of measurement generation
  longitude NUMERIC, -- Longitude coordinate of the geoposition of the device at the specific timestamp of measurement generation
  altitude NUMERIC, -- Altitude coordinate of the geopositioning of the device at the specific timestamp of measurement generation
  geohash TEXT, -- Geohash that express the geoposition of the device at the specific timestamp of measurement generation
  "accX" NUMERIC, -- X-axis accelerometer value
  "accY" NUMERIC, -- Y-axis accelerometer value
  "accZ" NUMERIC, -- Z-axis accelerometer value
  "activityAnomaly" BOOLEAN,  -- True if the collar detects abnormal movement patterns
  "distanceAnomaly" BOOLEAN,  -- True if the collar moved a long distance in a short time
  "positionAnomaly" BOOLEAN,  -- True if GPS data is invalid or erratic
  "locationAnomaly" BOOLEAN,  -- True if the collar is outside its usual activity zone
  "temperatureAnomaly" BOOLEAN,  -- True if the recorded temperature is unusually high
  "resourceAlarm" BOOLEAN,  -- True if the device raised an alert (e.g. battery warning)
  "sequenceNumber" INTEGER, -- Sequence number of the measurement with respect to the other measurements generated by the same device
  temperature NUMERIC, -- Temperature value generated by the device
  CONSTRAINT key PRIMARY KEY ("entityName", "time")
);

### Response:
